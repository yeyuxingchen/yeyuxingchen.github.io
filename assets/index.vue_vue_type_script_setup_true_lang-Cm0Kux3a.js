
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as B,p as f,b as I,q as y,aK as P,ac as b,G as d,o as i,X as q,g as C,D as w,a0 as k,a1 as E,f as J,e as N,y as z}from"./index-DEvcBNPV.js";import{r as A,_ as $}from"./item.vue_vue_type_script_setup_true_lang-D1lyTsLn.js";import{_ as K}from"./sub.vue_vue_type_script_setup_true_lang-CzUbWKrk.js";const L=B({name:"MainMenu",__name:"index",props:{menu:{},value:{},accordion:{type:Boolean,default:!0},defaultOpeneds:{default:()=>[]},mode:{default:"vertical"},collapse:{type:Boolean,default:!1},showCollapseName:{type:Boolean,default:!1}},setup(O){const n=O,o=f(n.value),s=f({}),c=f({}),t=f(n.defaultOpeneds.slice(0)),S=f([]),p=I(()=>n.mode==="horizontal"||n.mode==="vertical"&&n.collapse);function M(e,l=[]){e.forEach(a=>{const u=a.path??JSON.stringify(a);if(a.children){const r=[...l,u];c.value[u]={index:u,indexPath:r,active:!1},M(a.children,r)}else s.value[u]={index:u,indexPath:l}})}const h=(e,l)=>{t.value.includes(e)||(n.accordion&&(t.value=t.value.filter(a=>l.includes(a))),t.value.push(e))},v=e=>{if(Array.isArray(e)){z(()=>{v(e.at(-1)),e.length>1&&v(e.slice(0,-1))});return}t.value=t.value.filter(l=>l!==e)};function _(e){var l,a;for(const u in c.value)c.value[u].active=!1;(l=c.value[e])==null||l.indexPath.forEach(u=>{c.value[u].active=!0}),(a=s.value[e])==null||a.indexPath.forEach(u=>{c.value[u].active=!0})}const g=e=>{(n.mode==="horizontal"||n.collapse)&&(t.value=[]),_(e)},x=(e,l)=>{t.value.includes(e)?v(e):h(e,l)};function m(){const e=o.value&&s.value[o.value];_(o.value),!(!e||p.value||n.collapse)&&e.indexPath.forEach(l=>{const a=c.value[l];a&&h(l,a.indexPath)})}return y(()=>n.menu,e=>{M(e),m()},{deep:!0,immediate:!0}),y(()=>n.value,e=>{s.value[e]||(o.value="");const l=s.value[e]||o.value&&s.value[o.value]||s.value[n.value];l?o.value=l.index:o.value=e,m()}),y(()=>n.collapse,e=>{e&&(t.value=[]),m()}),P(A,b({props:n,items:s,subMenus:c,activeIndex:o,openedMenus:t,mouseInMenu:S,isMenuPopup:p,openMenu:h,closeMenu:v,handleMenuItemClick:g,handleSubMenuClick:x})),(e,l)=>(i(),d("div",{class:q(C(w)("h-full w-full flex flex-col of-hidden transition-all-300",{"flex-row w-auto":C(p)&&n.mode==="horizontal","py-1":n.mode==="vertical"}))},[(i(!0),d(k,null,E(e.menu,a=>{var u,r;return i(),d(k,{key:a.path??JSON.stringify(a)},[((u=a.meta)==null?void 0:u.menu)!==!1?(i(),d(k,{key:0},[(r=a.children)!=null&&r.length?(i(),N(K,{key:0,menu:a,"unique-key":[a.path??JSON.stringify(a)]},null,8,["menu","unique-key"])):(i(),N($,{key:1,item:a,"unique-key":[a.path??JSON.stringify(a)],onClick:j=>g(a.path??JSON.stringify(a))},null,8,["item","unique-key","onClick"]))],64)):J("",!0)],64)}),128))],2))}});export{L as _};
