
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as K,aP as w,b as d,aH as T,D as h,G as m,o as c,a0 as y,k as x,e as g,f as v,g as n,aQ as z,T as $,m as F,aR as I,w as H,aw as A,X as E,a1 as L,Z as N,aS as k,y as J}from"./index-DEvcBNPV.js";import{_ as O,r as j}from"./item.vue_vue_type_script_setup_true_lang-D1lyTsLn.js";const D=K({name:"SubMenu",__name:"sub",props:{uniqueKey:{},menu:{},level:{default:0}},setup(S){const s=S,f=s.menu.path??JSON.stringify(s.menu),M=w("itemRef"),C=w("subMenuRef"),t=T(j),b=d(()=>t.openedMenus.includes(s.uniqueKey.at(-1))),P=d(()=>t.isMenuPopup?{enter(e){e.offsetHeight>window.innerHeight&&(e.style.height=`${window.innerHeight}px`)},afterEnter:()=>{},beforeLeave:e=>{e.style.maxHeight=`${e.offsetHeight}px`,e.style.overflow="hidden"},leave:e=>{e.style.maxHeight="0"},afterLeave(e){e.style.maxHeight="",e.style.overflow=""}}:CSS.supports("height","calc-size(auto, size)")?{}:{enter(e){requestAnimationFrame(()=>{e.dataset.height=e.offsetHeight.toString(),e.style.maxHeight="0",e.offsetHeight,e.style.maxHeight=`${e.dataset.height}px`,e.style.overflow="hidden"})},afterEnter(e){e.style.maxHeight="",e.style.overflow=""},enterCancelled(e){e.style.maxHeight="",e.style.overflow=""},beforeLeave(e){e.style.maxHeight=`${e.offsetHeight}px`,e.style.overflow="hidden"},leave(e){e.style.maxHeight="0"},afterLeave(e){e.style.maxHeight="",e.style.overflow=""},leaveCancelled(e){e.style.maxHeight="",e.style.overflow=""}}),R=d(()=>t.isMenuPopup?{enterActiveClass:"ease-in-out duration-300",enterFromClass:"opacity-0 translate-x-4",enterToClass:"opacity-100",leaveActiveClass:"ease-in-out duration-300",leaveFromClass:"opacity-100",leaveToClass:"opacity-0"}:{enterActiveClass:"ease-in-out duration-300",enterFromClass:h("opacity-0 translate-y-4 scale-95 blur-4",CSS.supports("height","calc-size(auto, size)")&&"h-0"),enterToClass:"opacity-100 translate-y-0 scale-100 blur-0",leaveActiveClass:"ease-in-out duration-300",leaveFromClass:"opacity-100 translate-y-0 scale-100 blur-0",leaveToClass:h("opacity-0 translate-y-4 scale-95 blur-4",CSS.supports("height","calc-size(auto, size)")&&"h-0")}),r=d(()=>{var e;return((e=s.menu.children)==null?void 0:e.some(i=>{var a;return((a=i.meta)==null?void 0:a.menu)!==!1}))??!1});function q(){var e;t.isMenuPopup&&r.value||(e=s.menu.meta)!=null&&e.link||(r.value?t.handleSubMenuClick(f,s.uniqueKey):t.handleMenuItemClick(f))}let u;function _(){t.isMenuPopup&&(t.mouseInMenu=s.uniqueKey,u==null||u(),{stop:u}=k(()=>{if(r.value)t.openMenu(f,s.uniqueKey),J(()=>{var o,p;const e=(o=M.value)==null?void 0:o.ref,i=(p=C.value)==null?void 0:p.$el;if(!e||!i)return;let a=0,l=0;t.props.mode==="vertical"||s.level!==0?(a=e.getBoundingClientRect().top+e.scrollTop,l=e.getBoundingClientRect().left+e.getBoundingClientRect().width,a+i.offsetHeight>window.innerHeight&&(a=Math.max(0,window.innerHeight-i.offsetHeight))):(a=e.getBoundingClientRect().top+e.getBoundingClientRect().height,l=e.getBoundingClientRect().left,a+i.offsetHeight>window.innerHeight&&(i.style.height=`${window.innerHeight-a}px`)),l+i.offsetWidth>document.documentElement.clientWidth&&(l=e.getBoundingClientRect().left-e.getBoundingClientRect().width),i.style.top=`${a}px`,i.style.insetInlineStart=`${l}px`});else{const e=s.menu.children?t.subMenus[f].indexPath.at(-1):t.items[f].indexPath.at(-1);t.openMenu(e,t.subMenus[e].indexPath)}},300))}function B(){t.isMenuPopup&&(t.mouseInMenu=[],u==null||u(),{stop:u}=k(()=>{t.mouseInMenu.length===0?t.closeMenu(s.uniqueKey):r.value&&!t.mouseInMenu.includes(s.uniqueKey.at(-1))&&t.closeMenu(s.uniqueKey.at(-1))},300))}return(e,i)=>{const a=N("SubMenu"),l=A;return c(),m(y,null,[x(O,{ref_key:"itemRef",ref:M,"unique-key":e.uniqueKey,item:e.menu,level:e.level,"sub-menu":n(r),expand:n(b),onClick:q,onMouseenter:_,onMouseleave:B},null,8,["unique-key","item","level","sub-menu","expand"]),n(r)?(c(),g(z,{key:0,to:"body",disabled:!n(t).isMenuPopup},[x($,F(n(R),I(n(P))),{default:H(()=>[n(b)?(c(),g(l,{key:0,ref_key:"subMenuRef",ref:C,scrollbar:!1,mask:n(t).isMenuPopup,class:E(n(h)("sub-menu static h-[calc-size(auto,size)] rounded-lg",{"bg-[var(--g-sub-sidebar-bg)]":n(t).isMenuPopup,"border shadow-xl fixed z-3000 w-[200px]":n(t).isMenuPopup,"mx-1":n(t).isMenuPopup&&(n(t).props.mode==="vertical"||e.level!==0),"py-1":n(t).isMenuPopup}))},{default:H(()=>[(c(!0),m(y,null,L(e.menu.children,o=>{var p;return c(),m(y,{key:o.path??JSON.stringify(o)},[((p=o.meta)==null?void 0:p.menu)!==!1?(c(),g(a,{key:0,"unique-key":[...e.uniqueKey,o.path??JSON.stringify(o)],menu:o,level:e.level+1},null,8,["unique-key","menu","level"])):v("",!0)],64)}),128))]),_:1},8,["mask","class"])):v("",!0)]),_:1},16)],8,["disabled"])):v("",!0)],64)}}});export{D as _};
